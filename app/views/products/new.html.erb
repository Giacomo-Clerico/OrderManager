<h1 class="text-xl font-bold mb-4">New Product</h1>

<%= form_with(model: @product, local: true, class: "space-y-4") do |f| %>
<% if @product.errors.any? %>
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
    <h2 class="font-semibold">
        <%= pluralize(@product.errors.count, "error") %> prohibited this product from being saved:
    </h2>
    <ul class="list-disc ml-6 mt-2">
        <% @product.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
        <% end %>
    </ul>
    </div>
<% end %>

<div>
    <%= f.label :code, class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.text_field :code, class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
</div>

<div>
    <%= f.label :desctription, "Description", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.rich_text_area :desctription, class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
</div>

<div>
    <%= f.label :category, class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.select :category, options_for_select(@categories, @product.category), {}, class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
</div>

<div>
    <%= f.label :product_type, class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.text_field :product_type, class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
</div>

<fieldset class="border-t border-gray-200 pt-4 mt-4">
    <legend class="text-lg font-semibold mb-2 text-gray-800">Initial Stock Information (optional)</legend>

    <div class="mb-3">
    <%= label_tag :initial_storage_id, "Storage", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= select_tag :initial_storage_id,
            options_from_collection_for_select(Storage.all, :id, :abbreviation),
            prompt: "Select a storage",
            class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    <%= hidden_field_tag :initial_storage_type, "Storage" %>
    </div>

    <div class="mb-3">
    <%= label_tag :initial_location, "Location", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= text_field_tag :initial_location, params[:initial_location], class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    </div>

    <div class="mb-3">
    <%= label_tag :initial_stock_quantity, "Initial Stock Quantity", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= number_field_tag :initial_stock_quantity, params[:initial_stock_quantity], min: 0, class: "w-full border rounded px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    </div>
</fieldset>

<div class="flex space-x-4 mt-4">
    <%= f.submit "Create Product", class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500" %>
    <%= link_to "Cancel", products_path, class: "px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400" %>
</div>
<% end %>
